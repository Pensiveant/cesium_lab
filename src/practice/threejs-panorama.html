<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <!-- Include the CesiumJS JavaScript and CSS files -->
    <title>cesium融合three.js 全景图</title>
    <script src="../demo/js/importCesium.js"></script>
    <script type="importmap">
        {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@v0.157.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.157.0/examples/jsm/"
        }
        }
</script>
    <style>
        html,
        body {
            height: 100vh;
            width: 100vw;
            margin: 0;
            padding: 0;
        }

        #cesiumContainer {
            width: 100%;
            height: 100%;
        }

        .weather-box {
            position: absolute;
            top: 100px;
            right: 100px;
            z-index: 2;
        }

        .weather-box button {
            cursor: pointer;
        }

        #threeCtn {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            margin: 0;
            overflow: hidden;
            padding: 0;
            font-family: sans-serif;
            pointer-events: none;
        }
    </style>
</head>

<body>
    <div id="cesiumContainer">

    </div>
    <div id="threeCtn"></div>
    <script type="module">
        // 初始化view
        import createViewer from "../demo/js/initViewer.js";
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import Panorama from './js/Panorama.js';


        const viewer = createViewer({
            isPositionPick: true
        });
        let isFlyTo = false;
        // 定位到成都
        viewer.camera.flyTo({
            destination: Cesium.Cartesian3.fromDegrees(104.06175, 30.65512, 1400),
            complete: function () {
                console.log('定位完成');
                isFlyTo = true;
            }
        });
        window.viewer = viewer;

        let clock = setInterval(() => {
            if (isFlyTo) {
                let panorama = new Panorama({
                    viewer,
                    panoramaUrl: './img/panoramaView.jpg',
                    position: [104.06175, 30.65512, 1400],
                    THREE,
                });
                clearInterval(clock);
            }
        }, 300);   
    </script>
</body>

</html>